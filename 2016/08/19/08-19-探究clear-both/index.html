<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="小前端，on my way~">
  <meta name="keyword" content="hexo-theme, vuejs">
  <title>
    
      探究clear:both | 鸦杀&#39;s Blog
    
  </title>
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/gitment.css">
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>
  <script src="/js/qrious.js"></script>
<script src="/js/gitment.js"></script>
  
  
    <!-- MathJax support START -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- MathJax support END -->
  


</head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <!--<div class="logo"></div>-->
      <span>鸦杀's Blog</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>探究clear:both</h2>
  <p class="post-date">2016-08-19</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><p>小伙伴们必定不会对下面这段清除浮动的代码感到陌生：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">.clearfix:after&#123;   </span><br><span class="line"> content: &apos;&apos;;  </span><br><span class="line"> display: block;  </span><br><span class="line"> clear: both;  </span><br><span class="line"> height: 0;  </span><br><span class="line"> visibility: hidden;  </span><br><span class="line">&#125;  </span><br><span class="line">*/  </span><br><span class="line">.clearfix&#123; /*兼容 IE*/  </span><br><span class="line"> zoom: 1;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>今天，我们不谈BFC和IE6的haslayout，来探究clear:both这个看似不起眼的属性。</p>
<p>先看一个demo（非常规用法）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">&lt;html&gt;  </span><br><span class="line"> &lt;head&gt;head&gt;  </span><br><span class="line"> &lt;body&gt;  </span><br><span class="line"> &lt;div class=&quot;wrap&quot;&gt;  </span><br><span class="line"> &lt;div class=&quot;left&quot;&gt;  </span><br><span class="line"> 我是左边，我比较高  </span><br><span class="line"> div&gt;  </span><br><span class="line"> &lt;div class=&quot;right&quot;&gt;  </span><br><span class="line"> 我是右边,我比较矮  </span><br><span class="line"> div&gt;  </span><br><span class="line"> div&gt;  </span><br><span class="line"> body&gt;  </span><br><span class="line">html&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.wrap &#123;  </span><br><span class="line"> background-color: #edd;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">.left &#123;  </span><br><span class="line"> float: left;  </span><br><span class="line"> height:200px;  </span><br><span class="line"> width:70%;  </span><br><span class="line"> background-color:#dee;  </span><br><span class="line">&#125;  </span><br><span class="line">.right &#123;  </span><br><span class="line"> background-color:#333;  </span><br><span class="line"> color:#fff;  </span><br><span class="line">&#125;  </span><br><span class="line">.right:after&#123;  </span><br><span class="line"> content:&apos;&apos;;  </span><br><span class="line"> display:block;  </span><br><span class="line"> clear: both;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>你以为它应该是这样的。。。</p>
<iframe style="width: 100%; height: 220px" src="http://sandbox.runjs.cn/show/mkak3o8h" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

<p>但实际上它是这样的。。。</p>
<iframe style="width: 100%; height: 220px" src="http://sandbox.runjs.cn/show/03vjjz78" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

<h3 id="what-happend"><a href="#what-happend" class="headerlink" title="what-happend"></a>what-happend</h3><p>在W3C中对<a href="https://www.w3.org/TR/CSS2/visuren.html#propdef-clear" target="_blank" rel="noopener"><code>clear:both</code>的解释</a>如下：</p>
<blockquote>
<p>both<br>Requires that the top border edge of the box be below the bottom outer edge of any right-floating and left-floating boxes that resulted from elements earlier in the source document.</p>
</blockquote>
<p>大致意思是说，如果一个元素被添加了clear:both，它的上边框边缘应该在前面左浮动或者右浮动的元素的外边距的下面。</p>
<p>在这里。<code>.right</code>元素并未被指定为浮动，但是我们在<code>.right</code>的after伪元素上清除浮动，它带来了一些副作用：观察它的computed style，发现它的值是<code>200px</code>。就好像高度自动被填充了（设置<code>height:auto</code>也有此现象）。</p>
<h5 id="如何解决？？当然是把clearfix加到·wrap上啦。-“如何解决？？当然是把clearfix加到·wrap上啦。”-如何解决？？当然是把clearfix加到·wrap上啦。"><a href="#如何解决？？当然是把clearfix加到·wrap上啦。-“如何解决？？当然是把clearfix加到·wrap上啦。”-如何解决？？当然是把clearfix加到·wrap上啦。" class="headerlink" title="如何解决？？当然是把clearfix加到·wrap上啦。 “如何解决？？当然是把clearfix加到·wrap上啦。”)如何解决？？当然是把clearfix加到·wrap上啦。"></a>如何解决？？当然是把clearfix加到·wrap上啦。 “如何解决？？当然是把clearfix加到·wrap上啦。”)如何解决？？当然是把clearfix加到<code>·wrap</code>上啦。</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">.wrap &#123;  </span><br><span class="line"> background-color: #edd;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">.left &#123;  </span><br><span class="line"> float: left;  </span><br><span class="line"> height:200px;  </span><br><span class="line"> width:70%;  </span><br><span class="line"> background-color:#dee;  </span><br><span class="line">&#125;  </span><br><span class="line">.right &#123;  </span><br><span class="line"> background-color:#333;  </span><br><span class="line"> color:#fff;  </span><br><span class="line">    </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">.wrap:after&#123;  </span><br><span class="line"> content:&apos;&apos;;  </span><br><span class="line"> display:block;  </span><br><span class="line"> clear: both;  </span><br><span class="line"> height:2px;  </span><br><span class="line"> background-color:#f00;  </span><br><span class="line"> width:100%;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可能有小伙伴说，可以为.right添加<code>overflow:hidden/auto</code>，或者指定一个具体的高度。我曾经在stackoverflow上也看到过这样的答案，那么，你要失望了，因为结果会是这样：</p>
<p><img src="http://ysha-01.oss-cn-shanghai.aliyuncs.com/QQ20160819073718.png" alt="指定overflow"></p>
<p>或者是这样的</p>
<p><img src="http://ysha-01.oss-cn-shanghai.aliyuncs.com/QQ20160819074532.png" alt="指定height值"></p>
<p>你还记得最初的目的是为了解决浮动么？╮(﹁_﹂)╭</p>
<p>好吧，这个例子告诉我们，清除浮动不是你想加就能加(⊙o⊙)… 所以最稳妥的办法还是把<code>clearfix</code>加在<code>.wrap</code>上。</p>
<p>细心的小伙伴会发现，上面两张图中伪元素的位置不一致啊。加了overflow:hidden的伪元素，它的上边框并没有在<code>.left</code>的下面。我们继续来看<a href="https://www.w3.org/TR/CSS2/visuren.html#propdef-clear" target="_blank" rel="noopener">W3C文档</a>：</p>
<blockquote>
<p>This property indicates which sides of an element’s box(es) may not be adjacent to an earlier floating box. The ‘clear’ property does not consider floats inside the element itself or in other block formatting contexts.</p>
</blockquote>
<h5 id="原因在这里，块级格式化上下文！！！clear属性不会影响其它块级格式化上下文。"><a href="#原因在这里，块级格式化上下文！！！clear属性不会影响其它块级格式化上下文。" class="headerlink" title="[](#原因在这里，块级格式化上下文！！！clear属性不会影响其它块级格式化上下文。"></a>[](#原因在这里，块级格式化上下文！！！clear属性不会影响其它块级格式化上下文。</h5><p>设置为<code>overflow:hidden;</code>的<code>.right</code>元素已经形成自己的BFC，不再影响<code>.wrap</code>。</p>
<p>众所周知，触发BFC的条件其中就包含了<code>overflow:hidden</code>。介于这篇文章BFC不是重点，我们就简单列下BFC的触发条件，到此结束吧^^。</p>
<p>触发BFC的条件：</p>
<ul>
<li><p>float 除了none以外的值</p>
</li>
<li><p>overflow 除了visible 以外的值（hidden，auto，scroll ）</p>
</li>
<li><p>display (table-cell，table-caption，inline-block)</p>
</li>
<li><p>position（absolute，fixed）</p>
</li>
<li><p>fieldset元素</p>
</li>
</ul>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tages#css" >
    <span class="tag-code">css</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2016/07/25/07-25-什么是Etag/">
        <span class="nav-arrow">← </span>
        
          什么是Etag
        
      </a>
    
    
      <a class="nav-right" href="/2016/08/21/08-21-background-positon-x与background-position-y坑点小计/">
        
          background-positon-x与background-position-y坑点小计
        
        <span class="nav-arrow"> →</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- 打赏 START -->
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    
      <div class="qrcode">
        <canvas id="share-qrcode"></canvas>
        <p class="notice">扫描二维码，分享此文章</p>
      </div>
    
    <!-- 二维码 END -->
    
      <!-- Gitment START -->
      <div id="comments"></div>
      <!-- Gitment END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'https://juzhishang.github.io/2016/08/19/08-19-探究clear-both/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

     // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()
        
        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })

    // qrcode
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });

    // gitment
    var gitmentConfig = "juzhishang";
    if (gitmentConfig !== 'undefined') {
      var gitment = new Gitment({
        id: "探究clear:both",
        owner: "juzhishang",
        repo: "juzhishang.github.io",
        oauth: {
          client_id: "19a4bb92d652487fe51f",
          client_secret: "1758eabb0def22e0a6b8edab473245799754c012"
        },
        theme: {
          render(state, instance) {
            const container = document.createElement('div')
            container.lang = "en-US"
            container.className = 'gitment-container gitment-root-container'
            container.appendChild(instance.renderHeader(state, instance))
            container.appendChild(instance.renderEditor(state, instance))
            container.appendChild(instance.renderComments(state, instance))
            container.appendChild(instance.renderFooter(state, instance))
            return container;
          }
        }
      })
      gitment.render(document.getElementById('comments'))
    }
  })();
</script>

    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2019 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
    <br>
    Theme by <a href="https://github.com/yanm1ng">yanm1ng</a>
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>
  </body>
</html>